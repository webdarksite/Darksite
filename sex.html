<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DARKSIDE Premium Service</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Padauk:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body { 
            background-color: #050505; 
            color: #f1f5f9; 
            font-family: 'Padauk', sans-serif; 
            overflow-x: hidden; 
            min-height: 100vh;
        }
        
        .neon-text { 
            text-shadow: 0 0 10px #ec4899, 0 0 20px #ec4899, 0 0 30px #ec4899; 
        }
        
        .glass { 
            background: rgba(15, 23, 42, 0.9); 
            backdrop-filter: blur(20px); 
            border: 1px solid rgba(255,255,255,0.1); 
            box-shadow: 0 15px 35px rgba(0,0,0,0.6);
        }
        
        .slider-container { 
            overflow-x: auto; 
            scroll-snap-type: x mandatory; 
            display: flex; 
            gap: 12px; 
            scrollbar-width: none; 
            border-radius: 20px; 
            padding: 8px;
            min-height: 320px;
        }
        
        .slider-container::-webkit-scrollbar { 
            display: none; 
        }
        
        .slide-item { 
            flex: 0 0 85%; 
            scroll-snap-align: center; 
            border-radius: 15px; 
            height: 300px; 
            object-fit: cover; 
            border: 1px solid rgba(255,255,255,0.15);
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
        }
        
        .resting-image-placeholder {
            flex: 0 0 85%;
            scroll-snap-align: center;
            border-radius: 15px;
            height: 300px;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border: 2px dashed rgba(255,255,255,0.1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .post-card { 
            margin-bottom: 30px; 
            position: relative;
            transition: all 0.3s ease;
        }
        
        .post-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(236, 72, 153, 0.2);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%);
            transition: all 0.3s ease;
            font-weight: 900;
        }
        
        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 0 25px rgba(236, 72, 153, 0.6);
        }
        
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }
        
        .input-field {
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.15);
            color: white;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #ec4899;
            box-shadow: 0 0 15px rgba(236, 72, 153, 0.4);
            background: rgba(255,255,255,0.12);
        }
        
        .input-field::placeholder {
            color: rgba(255,255,255,0.4);
        }
        
        .loading-spinner {
            border: 5px solid rgba(255,255,255,0.1);
            border-left-color: #ec4899;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1.2s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .pulse {
            animation: pulse 2s infinite ease-in-out;
        }
        
        @keyframes pulse {
            0% { 
                opacity: 1;
                text-shadow: 0 0 10px #ec4899, 0 0 20px #ec4899, 0 0 30px #ec4899;
            }
            50% { 
                opacity: 0.8;
                text-shadow: 0 0 15px #ec4899, 0 0 30px #ec4899, 0 0 45px #ec4899;
            }
            100% { 
                opacity: 1;
                text-shadow: 0 0 10px #ec4899, 0 0 20px #ec4899, 0 0 30px #ec4899;
            }
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
            animation: status-pulse 2s infinite;
        }
        
        @keyframes status-pulse {
            0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); }
            100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }
        
        .online { 
            background-color: #10b981; 
            box-shadow: 0 0 10px #10b981;
        }
        
        .offline { 
            background-color: #ef4444;
            animation: none;
        }
        
        .resting-badge {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            animation: resting-pulse 2s infinite;
        }
        
        @keyframes resting-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .available-badge {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.5);
        }
        
        .admin-controls {
            background: rgba(0,0,0,0.3);
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .shake {
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        /* Image Upload Styling */
        .image-upload-container {
            position: relative;
            min-height: 200px;
        }
        
        .image-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .image-preview-item {
            position: relative;
            width: 100px;
            height: 100px;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .image-preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .remove-image-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(239, 68, 68, 0.9);
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
        }
        
        .upload-area {
            border: 2px dashed rgba(255,255,255,0.3);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.05);
        }
        
        .upload-area:hover {
            border-color: #ec4899;
            background: rgba(236, 72, 153, 0.1);
        }
        
        .upload-area.dragover {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
            transform: scale(1.02);
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ec4899, #8b5cf6);
            transition: width 0.3s ease;
        }
        
        .camera-preview {
            width: 100%;
            max-width: 300px;
            border-radius: 15px;
            overflow: hidden;
            margin: 0 auto;
            display: none;
        }
        
        #cameraVideo {
            width: 100%;
            height: auto;
            transform: scaleX(-1);
        }
        
        .camera-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }
    </style>
</head>
<body class="pb-24">

    <!-- Header Section -->
    <div class="text-center py-10 px-4 fade-in">
        <h1 id="adminTrigger" class="text-5xl md:text-6xl font-black neon-text text-pink-500 tracking-tighter mb-4 cursor-pointer pulse hover:scale-105 transition-transform duration-300">
            DARKSIDE
        </h1>
        <p class="text-gray-200 text-base md:text-lg font-bold px-6 mb-2">
            Sexchat & Dategirl & ·ÄÖ·Äï·ÄΩ·Äî·Ä∫·ÄÜ·Ä¨·Äô·Äª·Ä¨·Ä∏
        </p>
        <p class="text-pink-400 font-black italic underline text-sm md:text-base mb-4">
            Fb ·Äê·Ä≠·ÄØ·Ä∑·ÄÜ·ÄÄ·Ä∫·Äû·ÄΩ·Äö·Ä∫·Äõ·Äî·Ä∫·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫
        </p>
        <div class="mt-6 text-sm text-gray-400 glass rounded-2xl py-3 px-6 inline-block">
            <span class="status-dot online"></span> 
            <span class="font-bold">·Äú·ÄÄ·Ä∫·Äõ·Äæ·Ä≠ Post: <span id="postCount" class="text-white">0</span></span>
            <span class="mx-3">|</span>
            <span class="text-green-400 font-bold" id="availableCount">0</span> ·Äö·Ä±·Ä¨·ÄÄ·Ä∫ ·Äõ·Äõ·Äæ·Ä≠·Äî·Ä≠·ÄØ·ÄÑ·Ä∫
            <span class="mx-3">|</span>
            <span class="text-yellow-400 font-bold" id="restingCount">0</span> ·Äö·Ä±·Ä¨·ÄÄ·Ä∫ ·Äö·Ä¨·Äö·ÄÆ·Äî·Ä¨·Ä∏
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="hidden glass m-4 p-6 rounded-3xl border-2 border-pink-500/50 max-w-md mx-auto fixed top-5 left-1/2 transform -translate-x-1/2 z-50 slide-in">
        <div class="flex justify-between items-center mb-6 pb-4 border-b border-white/10">
            <div>
                <h2 class="text-xl font-black text-yellow-400">
                    <i class="fas fa-user-shield mr-2"></i>ADMIN POST PANEL
                </h2>
                <p class="text-gray-400 text-xs mt-1">Post ·Ä°·Äû·ÄÖ·Ä∫·Äê·ÄÑ·Ä∫·Äõ·Äî·Ä∫ / ·ÄÖ·ÄÆ·Äô·Ä∂·Äõ·Äî·Ä∫</p>
            </div>
            <button onclick="closeAdmin()" class="text-gray-400 hover:text-white hover:bg-white/10 w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        
        <div class="space-y-5">
            <div>
                <label class="block text-pink-400 font-bold mb-2 text-sm">
                    <i class="fas fa-user mr-2"></i>·Äî·Ä¨·Äô·Ää·Ä∫
                </label>
                <input type="text" id="nameIn" placeholder="·Ä°·Äô·Ää·Ä∫·Äë·Ää·Ä∑·Ä∫·Äï·Ä´" class="w-full p-4 rounded-2xl input-field text-lg">
            </div>
            
            <div class="grid grid-cols-2 gap-3">
                <div>
                    <label class="block text-pink-400 font-bold mb-2 text-sm">
                        <i class="fas fa-birthday-cake mr-2"></i>·Ä°·Äû·ÄÄ·Ä∫
                    </label>
                    <input type="number" id="ageIn" placeholder="·Ä°·Äû·ÄÄ·Ä∫" class="w-full p-4 rounded-2xl input-field">
                </div>
                <div>
                    <label class="block text-pink-400 font-bold mb-2 text-sm">
                        <i class="fas fa-clock mr-2"></i>·Ä°·ÄÅ·Äª·Ä≠·Äî·Ä∫
                    </label>
                    <input type="text" id="timeIn" placeholder="24/7, 9AM-5PM" class="w-full p-4 rounded-2xl input-field">
                </div>
            </div>
            
            <div>
                <label class="block text-pink-400 font-bold mb-2 text-sm">
                    <i class="fas fa-money-bill-wave mr-2"></i>·ÄÖ·Äª·Ä±·Ä∏·Äî·Äæ·ÄØ·Äî·Ä∫·Ä∏
                </label>
                <input type="text" id="priceIn" placeholder="15000 Ks, 20000 Ks" class="w-full p-4 rounded-2xl input-field">
            </div>
            
            <!-- Image Upload Section -->
            <div class="glass p-4 rounded-2xl border border-white/10">
                <label class="block text-pink-400 font-bold mb-2">
                    <i class="fas fa-images mr-2"></i>·Äï·ÄØ·Ä∂·Äô·Äª·Ä¨·Ä∏·Äê·ÄÑ·Ä∫·Äõ·Äî·Ä∫
                </label>
                
                <!-- Image Upload Area -->
                <div class="image-upload-container">
                    <div id="uploadArea" class="upload-area">
                        <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-3"></i>
                        <p class="text-gray-300 font-bold mb-1">·Äï·ÄØ·Ä∂·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ ·Äí·ÄÆ·Äî·Ä±·Äõ·Ä¨·Äê·ÄΩ·ÄÑ·Ä∫ ·ÄÜ·ÄΩ·Ä≤·ÄÅ·Äª·ÄÅ·Äª·Äï·Ä´</p>
                        <p class="text-gray-400 text-sm">·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫</p>
                        <div class="flex flex-col sm:flex-row gap-2 mt-3">
                            <button onclick="document.getElementById('fileInput').click()" 
                                    class="bg-gradient-to-r from-blue-600 to-blue-700 text-white py-3 px-6 rounded-xl font-bold hover:scale-105 transition-transform duration-300">
                                <i class="fas fa-folder-open mr-2"></i>·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫·Äõ·ÄΩ·Ä±·Ä∏·Äõ·Äî·Ä∫
                            </button>
                            <button onclick="openCamera()" 
                                    class="bg-gradient-to-r from-green-600 to-green-700 text-white py-3 px-6 rounded-xl font-bold hover:scale-105 transition-transform duration-300">
                                <i class="fas fa-camera mr-2"></i>·ÄÄ·ÄÑ·Ä∫·Äô·Äõ·Ä¨
                            </button>
                        </div>
                        <p class="text-gray-400 text-xs mt-3">
                            <i class="fas fa-info-circle mr-1"></i>
                            JPG, PNG, WebP ·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫·Äô·Äª·Ä¨·Ä∏ (·Ä°·Äô·Äª·Ä¨·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏ 5MB/·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫)
                        </p>
                    </div>
                    
                    <!-- File Input (Hidden) -->
                    <input type="file" id="fileInput" accept="image/*" multiple style="display: none;">
                    
                    <!-- Camera Preview -->
                    <div id="cameraPreview" class="camera-preview">
                        <video id="cameraVideo" autoplay></video>
                        <div class="camera-controls">
                            <button onclick="takePhoto()" class="bg-red-500 text-white w-16 h-16 rounded-full hover:scale-110 transition-transform duration-300">
                                <i class="fas fa-camera text-xl"></i>
                            </button>
                            <button onclick="closeCamera()" class="bg-gray-700 text-white w-12 h-12 rounded-full hover:scale-110 transition-transform duration-300">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Upload Progress -->
                    <div id="uploadProgress" class="hidden">
                        <div class="flex justify-between text-sm text-gray-300 mb-1">
                            <span>·Äê·ÄÑ·Ä∫·Äî·Ä±·Äû·Ää·Ä∫...</span>
                            <span id="uploadPercentage">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <!-- Image Preview -->
                    <div id="imagePreview" class="image-preview mt-4"></div>
                    
                    <!-- Image URLs (Hidden, for editing) -->
                    <textarea id="imgLinks" class="hidden"></textarea>
                </div>
            </div>
            
            <div class="flex items-center gap-3 p-4 bg-yellow-500/10 rounded-2xl border border-yellow-500/20">
                <input type="checkbox" id="restingIn" class="w-6 h-6 rounded accent-yellow-500">
                <label for="restingIn" class="text-yellow-400 font-bold">
                    <i class="fas fa-clock mr-2"></i>·Äö·Ä¨·Äö·ÄÆ·Äî·Ä¨·Ä∏·Äë·Ä¨·Ä∏·Äô·Ää·Ä∫
                </label>
            </div>
            
            <div class="grid grid-cols-2 gap-3 pt-4">
                <button onclick="publishPost()" class="bg-gradient-to-r from-green-600 to-emerald-700 hover:from-green-700 hover:to-emerald-800 text-white py-4 rounded-2xl shadow-xl font-bold transition-all duration-300 hover:scale-[1.02]">
                    <i class="fas fa-paper-plane mr-2"></i>POST ·Äê·ÄÑ·Ä∫·Äô·Ää·Ä∫
                </button>
                <button onclick="clearForm()" class="bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-800 hover:to-gray-900 text-white py-4 rounded-2xl shadow-xl font-bold transition-all duration-300 hover:scale-[1.02]">
                    <i class="fas fa-eraser mr-2"></i>·Äõ·Äæ·ÄÑ·Ä∫·Ä∏·Äô·Ää·Ä∫
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Indicator -->
    <div id="loading" class="flex flex-col justify-center items-center py-20 fade-in">
        <div class="loading-spinner mb-6"></div>
        <p class="text-gray-400 text-lg font-bold">Post ·Äô·Äª·Ä¨·Ä∏·Äõ·Äæ·Ä¨·Äî·Ä±·Äû·Ää·Ä∫...</p>
        <p class="text-gray-500 text-sm mt-2">·ÄÅ·Äè·ÄÖ·Ä±·Ä¨·ÄÑ·Ä∫·Ä∑·Äï·Ä±·Ä∏·Äï·Ä´</p>
    </div>

    <!-- Posts Feed -->
    <div id="postFeed" class="max-w-md mx-auto px-4"></div>

    <!-- Edit Modal -->
    <div id="editModal" class="hidden fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4">
        <div class="glass rounded-3xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-black text-yellow-400">
                    <i class="fas fa-edit mr-2"></i>Post ·Äï·Äº·ÄÑ·Ä∫·ÄÜ·ÄÑ·Ä∫·Äõ·Äî·Ä∫
                </h2>
                <button onclick="closeEditModal()" class="text-gray-400 hover:text-white">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="space-y-5">
                <div>
                    <label class="block text-pink-400 font-bold mb-2 text-sm">
                        <i class="fas fa-user mr-2"></i>·Äî·Ä¨·Äô·Ää·Ä∫
                    </label>
                    <input type="text" id="editName" class="w-full p-4 rounded-2xl input-field text-lg">
                </div>
                
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-pink-400 font-bold mb-2 text-sm">
                            <i class="fas fa-birthday-cake mr-2"></i>·Ä°·Äû·ÄÄ·Ä∫
                        </label>
                        <input type="number" id="editAge" class="w-full p-4 rounded-2xl input-field">
                    </div>
                    <div>
                        <label class="block text-pink-400 font-bold mb-2 text-sm">
                            <i class="fas fa-clock mr-2"></i>·Ä°·ÄÅ·Äª·Ä≠·Äî·Ä∫
                        </label>
                        <input type="text" id="editTime" class="w-full p-4 rounded-2xl input-field">
                    </div>
                </div>
                
                <div>
                    <label class="block text-pink-400 font-bold mb-2 text-sm">
                        <i class="fas fa-money-bill-wave mr-2"></i>·ÄÖ·Äª·Ä±·Ä∏·Äî·Äæ·ÄØ·Äî·Ä∫·Ä∏
                    </label>
                    <input type="text" id="editPrice" class="w-full p-4 rounded-2xl input-field">
                </div>
                
                <div class="flex items-center gap-3 p-4 bg-yellow-500/10 rounded-2xl border border-yellow-500/20">
                    <input type="checkbox" id="editResting" class="w-6 h-6 rounded accent-yellow-500">
                    <label for="editResting" class="text-yellow-400 font-bold">
                        <i class="fas fa-clock mr-2"></i>·Äö·Ä¨·Äö·ÄÆ·Äî·Ä¨·Ä∏·Äë·Ä¨·Ä∏·Äô·Ää·Ä∫
                    </label>
                </div>
                
                <!-- Image Management for Editing -->
                <div class="glass p-4 rounded-2xl border border-white/10">
                    <label class="block text-pink-400 font-bold mb-2">
                        <i class="fas fa-images mr-2"></i>·Äï·ÄØ·Ä∂·Äô·Äª·Ä¨·Ä∏·Äï·Äº·ÄÑ·Ä∫·ÄÜ·ÄÑ·Ä∫·Äõ·Äî·Ä∫
                    </label>
                    <div id="editImagePreview" class="image-preview mb-4"></div>
                    
                    <div class="flex flex-col sm:flex-row gap-2">
                        <button onclick="document.getElementById('editFileInput').click()" 
                                class="bg-gradient-to-r from-blue-600 to-blue-700 text-white py-3 px-4 rounded-xl font-bold text-sm hover:scale-105 transition-transform duration-300">
                            <i class="fas fa-plus mr-2"></i>·Äï·ÄØ·Ä∂·Ä°·Äû·ÄÖ·Ä∫·Äë·Ää·Ä∑·Ä∫·Äô·Ää·Ä∫
                        </button>
                        <input type="file" id="editFileInput" accept="image/*" multiple style="display: none;">
                    </div>
                </div>
                
                <div class="flex gap-3 pt-4">
                    <button onclick="saveEdit()" class="flex-1 bg-gradient-to-r from-green-600 to-emerald-700 hover:from-green-700 hover:to-emerald-800 text-white py-4 rounded-2xl shadow-xl font-bold transition-all duration-300 hover:scale-[1.02]">
                        <i class="fas fa-save mr-2"></i>·Äû·Ä≠·Äô·Ä∫·Ä∏·Äô·Ää·Ä∫
                    </button>
                    <button onclick="closeEditModal()" class="flex-1 bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-800 hover:to-gray-900 text-white py-4 rounded-2xl shadow-xl font-bold transition-all duration-300 hover:scale-[1.02]">
                        <i class="fas fa-times mr-2"></i>·Äô·Äû·Ä≠·Äô·Ä∫·Ä∏·Äï·Ä´
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="fixed bottom-0 left-0 right-0 glass border-t border-white/10 py-3 z-40 shadow-2xl">
        <div class="max-w-md mx-auto flex justify-around px-6">
            <button onclick="scrollToTop()" class="text-center text-gray-300 hover:text-white transition-all duration-300 hover:scale-110">
                <div class="bg-white/5 w-12 h-12 rounded-2xl flex items-center justify-center mx-auto mb-1">
                    <i class="fas fa-home text-xl"></i>
                </div>
                <p class="text-xs font-bold">·Äô·Ä∞·Äú</p>
            </button>
            
            <button id="refreshBtn" onclick="refreshPosts()" class="text-center text-gray-300 hover:text-white transition-all duration-300 hover:scale-110">
                <div class="bg-white/5 w-12 h-12 rounded-2xl flex items-center justify-center mx-auto mb-1">
                    <i class="fas fa-sync-alt text-xl"></i>
                </div>
                <p class="text-xs font-bold">Refresh</p>
            </button>
            
            <button id="adminBtn" onclick="openAdminPanel()" class="text-center text-pink-400 hover:text-pink-300 transition-all duration-300 hover:scale-110">
                <div class="bg-pink-500/20 w-12 h-12 rounded-2xl flex items-center justify-center mx-auto mb-1">
                    <i class="fas fa-user-shield text-xl"></i>
                </div>
                <p class="text-xs font-bold">Admin</p>
            </button>
        </div>
    </div>

    <script>
        // ============================================
        // FIREBASE CONFIGURATION
        // ============================================
        const firebaseConfig = {
            apiKey: "AIzaSyC4pLZv8Gp7X9qY6qJ6wKZkLmN8wQ6rT6s",
            authDomain: "darkside-777.firebaseapp.com",
            databaseURL: "https://darkside-777-default-rtdb.firebaseio.com",
            projectId: "darkside-777",
            storageBucket: "darkside-777.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdef1234567890"
        };
        
        // Initialize Firebase
        try {
            firebase.initializeApp(firebaseConfig);
        } catch (error) {
            console.log("Firebase already initialized");
        }
        
        const db = firebase.database().ref('posts');
        const storage = firebase.storage();
        
        // ============================================
        // DOM ELEMENTS
        // ============================================
        const adminPanel = document.getElementById('adminPanel');
        const postFeed = document.getElementById('postFeed');
        const loading = document.getElementById('loading');
        const postCount = document.getElementById('postCount');
        const availableCount = document.getElementById('availableCount');
        const restingCount = document.getElementById('restingCount');
        const refreshBtn = document.getElementById('refreshBtn');
        const editModal = document.getElementById('editModal');
        
        // ============================================
        // APP STATE
        // ============================================
        let isAdmin = false;
        let currentPosts = [];
        let uploadedImages = []; // For new posts
        let editingImages = []; // For editing posts
        let editingPostId = null;
        let cameraStream = null;
        
        // ============================================
        // IMAGE UPLOAD FUNCTIONS
        // ============================================
        
        // Initialize image upload
        function initializeImageUpload() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const imagePreview = document.getElementById('imagePreview');
            
            // Click to select files
            uploadArea.addEventListener('click', (e) => {
                if (!e.target.closest('button')) {
                    fileInput.click();
                }
            });
            
            // Drag and drop
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                handleImageFiles(files);
            });
            
            // File input change
            fileInput.addEventListener('change', (e) => {
                handleImageFiles(e.target.files);
                fileInput.value = '';
            });
            
            // Initialize for editing
            const editFileInput = document.getElementById('editFileInput');
            editFileInput.addEventListener('change', (e) => {
                handleEditImageFiles(e.target.files);
                editFileInput.value = '';
            });
        }
        
        // Handle image files
        function handleImageFiles(files) {
            const validFiles = Array.from(files).filter(file => {
                return file.type.startsWith('image/') && file.size <= 5 * 1024 * 1024;
            });
            
            if (validFiles.length === 0) {
                showNotification('‚ùå ·Äô·Äæ·Äî·Ä∫·ÄÄ·Äî·Ä∫·Äû·Ä±·Ä¨ ·Äï·ÄØ·Ä∂·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ·Äû·Ä¨ ·Äê·ÄÑ·Ä∫·Äï·Ä´', 'error');
                return;
            }
            
            // Process each file
            validFiles.forEach(file => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const imageData = e.target.result;
                    uploadedImages.push({
                        file: file,
                        preview: imageData,
                        url: null // Will be set after upload
                    });
                    updateImagePreview();
                };
                reader.readAsDataURL(file);
            });
            
            showNotification(`‚úÖ ${validFiles.length} ·Äï·ÄØ·Ä∂·Äë·Ää·Ä∑·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ`, 'success');
        }
        
        // Handle edit image files
        function handleEditImageFiles(files) {
            const validFiles = Array.from(files).filter(file => {
                return file.type.startsWith('image/') && file.size <= 5 * 1024 * 1024;
            });
            
            if (validFiles.length === 0) {
                showNotification('‚ùå ·Äô·Äæ·Äî·Ä∫·ÄÄ·Äî·Ä∫·Äû·Ä±·Ä¨ ·Äï·ÄØ·Ä∂·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ·Äû·Ä¨ ·Äê·ÄÑ·Ä∫·Äï·Ä´', 'error');
                return;
            }
            
            // Process each file
            validFiles.forEach(file => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const imageData = e.target.result;
                    editingImages.push({
                        file: file,
                        preview: imageData,
                        url: null,
                        isNew: true
                    });
                    updateEditImagePreview();
                };
                reader.readAsDataURL(file);
            });
            
            showNotification(`‚úÖ ${validFiles.length} ·Äï·ÄØ·Ä∂·Äë·Ää·Ä∑·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ`, 'success');
        }
        
        // Update image preview for new posts
        function updateImagePreview() {
            const imagePreview = document.getElementById('imagePreview');
            imagePreview.innerHTML = '';
            
            uploadedImages.forEach((image, index) => {
                const div = document.createElement('div');
                div.className = 'image-preview-item';
                div.innerHTML = `
                    <img src="${image.preview}" alt="Preview ${index + 1}">
                    <button onclick="removeImage(${index})" class="remove-image-btn">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                imagePreview.appendChild(div);
            });
            
            // Update hidden textarea with image URLs
            document.getElementById('imgLinks').value = uploadedImages.map(img => img.url || '').join(',');
        }
        
        // Update image preview for editing
        function updateEditImagePreview() {
            const editImagePreview = document.getElementById('editImagePreview');
            editImagePreview.innerHTML = '';
            
            editingImages.forEach((image, index) => {
                const div = document.createElement('div');
                div.className = 'image-preview-item';
                div.innerHTML = `
                    <img src="${image.preview || image.url}" alt="Preview ${index + 1}">
                    <button onclick="removeEditImage(${index})" class="remove-image-btn">
                        <i class="fas fa-times"></i>
                    </button>
                    ${image.isNew ? '<span class="absolute top-5 left-5 bg-green-500 text-white text-xs px-1 rounded">·Ä°·Äû·ÄÖ·Ä∫</span>' : ''}
                `;
                editImagePreview.appendChild(div);
            });
        }
        
        // Remove image from new post
        function removeImage(index) {
            uploadedImages.splice(index, 1);
            updateImagePreview();
        }
        
        // Remove image from editing
        function removeEditImage(index) {
            editingImages.splice(index, 1);
            updateEditImagePreview();
        }
        
        // Upload images to Firebase Storage
        async function uploadImages() {
            if (uploadedImages.length === 0) {
                showNotification('‚ùå ·Ä°·Äî·Ää·Ä∫·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏ ·Äï·ÄØ·Ä∂·Äê·ÄÖ·Ä∫·Äï·ÄØ·Ä∂·Äê·ÄÑ·Ä∫·Äï·Ä±·Ä∏·Äï·Ä´', 'error');
                return null;
            }
            
            const uploadProgress = document.getElementById('uploadProgress');
            const progressFill = document.getElementById('progressFill');
            const uploadPercentage = document.getElementById('uploadPercentage');
            
            uploadProgress.classList.remove('hidden');
            
            const imageUrls = [];
            const totalImages = uploadedImages.length;
            let completed = 0;
            
            for (let i = 0; i < uploadedImages.length; i++) {
                const image = uploadedImages[i];
                if (image.url) {
                    // Already uploaded
                    imageUrls.push(image.url);
                    completed++;
                    updateUploadProgress(completed, totalImages, progressFill, uploadPercentage);
                    continue;
                }
                
                try {
                    const fileName = `images/${Date.now()}_${i}_${image.file.name}`;
                    const storageRef = storage.ref(fileName);
                    const uploadTask = storageRef.put(image.file);
                    
                    await new Promise((resolve, reject) => {
                        uploadTask.on('state_changed',
                            (snapshot) => {
                                // Progress monitoring if needed
                            },
                            (error) => {
                                reject(error);
                            },
                            async () => {
                                const downloadURL = await uploadTask.snapshot.ref.getDownloadURL();
                                image.url = downloadURL;
                                imageUrls.push(downloadURL);
                                completed++;
                                updateUploadProgress(completed, totalImages, progressFill, uploadPercentage);
                                resolve();
                            }
                        );
                    });
                } catch (error) {
                    console.error('Upload error:', error);
                    showNotification(`‚ùå ·Äï·ÄØ·Ä∂·Äê·ÄÑ·Ä∫·Äõ·Ä¨·Äê·ÄΩ·ÄÑ·Ä∫ ·Ä°·Äô·Äæ·Ä¨·Ä∏·Äñ·Äº·ÄÖ·Ä∫·Äî·Ä±·Äû·Ää·Ä∫: ${error.message}`, 'error');
                    return null;
                }
            }
            
            uploadProgress.classList.add('hidden');
            return imageUrls;
        }
        
        // Upload edit images
        async function uploadEditImages() {
            const newImages = editingImages.filter(img => img.isNew && !img.url);
            
            if (newImages.length === 0) {
                // No new images to upload
                return editingImages.map(img => img.url || img.preview).filter(url => url);
            }
            
            const uploadProgress = document.getElementById('uploadProgress');
            const progressFill = document.getElementById('progressFill');
            const uploadPercentage = document.getElementById('uploadPercentage');
            
            uploadProgress.classList.remove('hidden');
            
            const totalImages = newImages.length;
            let completed = 0;
            
            for (let i = 0; i < newImages.length; i++) {
                const image = newImages[i];
                
                try {
                    const fileName = `images/${Date.now()}_${i}_${image.file.name}`;
                    const storageRef = storage.ref(fileName);
                    const uploadTask = storageRef.put(image.file);
                    
                    await new Promise((resolve, reject) => {
                        uploadTask.on('state_changed',
                            (snapshot) => {
                                // Progress monitoring
                            },
                            (error) => {
                                reject(error);
                            },
                            async () => {
                                const downloadURL = await uploadTask.snapshot.ref.getDownloadURL();
                                image.url = downloadURL;
                                completed++;
                                updateUploadProgress(completed, totalImages, progressFill, uploadPercentage);
                                resolve();
                            }
                        );
                    });
                } catch (error) {
                    console.error('Upload error:', error);
                    showNotification(`‚ùå ·Äï·ÄØ·Ä∂·Äê·ÄÑ·Ä∫·Äõ·Ä¨·Äê·ÄΩ·ÄÑ·Ä∫ ·Ä°·Äô·Äæ·Ä¨·Ä∏·Äñ·Äº·ÄÖ·Ä∫·Äî·Ä±·Äû·Ää·Ä∫: ${error.message}`, 'error');
                    return null;
                }
            }
            
            uploadProgress.classList.add('hidden');
            return editingImages.map(img => img.url).filter(url => url);
        }
        
        // Update upload progress
        function updateUploadProgress(completed, total, progressFill, uploadPercentage) {
            const percentage = Math.round((completed / total) * 100);
            progressFill.style.width = `${percentage}%`;
            uploadPercentage.textContent = `${percentage}%`;
        }
        
        // ============================================
        // CAMERA FUNCTIONS
        // ============================================
        
        // Open camera
        async function openCamera() {
            try {
                const constraints = {
                    video: {
                        facingMode: 'user',
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    },
                    audio: false
                };
                
                cameraStream = await navigator.mediaDevices.getUserMedia(constraints);
                const cameraVideo = document.getElementById('cameraVideo');
                const cameraPreview = document.getElementById('cameraPreview');
                const uploadArea = document.getElementById('uploadArea');
                
                cameraVideo.srcObject = cameraStream;
                cameraPreview.style.display = 'block';
                uploadArea.style.display = 'none';
                
                showNotification('üì∏ ·ÄÄ·ÄÑ·Ä∫·Äô·Äõ·Ä¨·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ', 'info');
            } catch (error) {
                console.error('Camera error:', error);
                showNotification('‚ùå ·ÄÄ·ÄÑ·Ä∫·Äô·Äõ·Ä¨·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Åç·Äô·Äõ·Äï·Ä´', 'error');
            }
        }
        
        // Take photo
        function takePhoto() {
            const cameraVideo = document.getElementById('cameraVideo');
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            
            canvas.width = cameraVideo.videoWidth;
            canvas.height = cameraVideo.videoHeight;
            
            // Flip horizontally for mirror effect
            context.translate(canvas.width, 0);
            context.scale(-1, 1);
            context.drawImage(cameraVideo, 0, 0, canvas.width, canvas.height);
            
            // Convert to blob
            canvas.toBlob((blob) => {
                const file = new File([blob], `photo_${Date.now()}.jpg`, { type: 'image/jpeg' });
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    uploadedImages.push({
                        file: file,
                        preview: e.target.result,
                        url: null
                    });
                    updateImagePreview();
                    closeCamera();
                    showNotification('‚úÖ ·Äï·ÄØ·Ä∂·Äõ·Ä≠·ÄØ·ÄÄ·Ä∫·Äö·Ä∞·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ', 'success');
                };
                reader.readAsDataURL(blob);
            }, 'image/jpeg', 0.9);
        }
        
        // Close camera
        function closeCamera() {
            if (cameraStream) {
                cameraStream.getTracks().forEach(track => track.stop());
                cameraStream = null;
            }
            
            const cameraPreview = document.getElementById('cameraPreview');
            const uploadArea = document.getElementById('uploadArea');
            const cameraVideo = document.getElementById('cameraVideo');
            
            cameraPreview.style.display = 'none';
            uploadArea.style.display = 'block';
            cameraVideo.srcObject = null;
        }
        
        // ============================================
        // ADMIN FUNCTIONS
        // ============================================
        
        // Open Admin Panel with Password
        function openAdminPanel() {
            const password = prompt("üîê Admin ·Äù·ÄÑ·Ä∫·Äõ·Äî·Ä∫ ·ÄÄ·ÄØ·Äí·Ä∫·Äë·Ää·Ä∑·Ä∫·Äï·Ä´:");
            
            if (password === "Z@w119241") {
                isAdmin = true;
                adminPanel.classList.remove('hidden');
                document.getElementById('adminBtn').classList.add('shake');
                setTimeout(() => {
                    document.getElementById('adminBtn').classList.remove('shake');
                }, 500);
                
                showNotification('‚úÖ Admin ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äû·Ä≠·ÄØ·Ä∑ ·Äù·ÄÑ·Ä∫·Äõ·Ä±·Ä¨·ÄÄ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ', 'success');
            } else if (password) {
                showNotification('‚ùå ·ÄÄ·ÄØ·Äí·Ä∫·Äô·Äæ·Ä¨·Ä∏·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫', 'error');
            }
        }
        
        // Close Admin Panel
        function closeAdmin() {
            adminPanel.classList.add('hidden');
            isAdmin = false;
        }
        
        // Clear Form
        function clearForm() {
            document.getElementById('nameIn').value = '';
            document.getElementById('ageIn').value = '';
            document.getElementById('timeIn').value = '';
            document.getElementById('priceIn').value = '';
            document.getElementById('restingIn').checked = false;
            
            // Clear images
            uploadedImages = [];
            updateImagePreview();
            
            showNotification('üìù Form ·Äõ·Äæ·ÄÑ·Ä∫·Ä∏·Äú·ÄÑ·Ä∫·Ä∏·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ', 'info');
        }
        
        // Publish New Post
        async function publishPost() {
            const name = document.getElementById('nameIn').value.trim();
            const age = document.getElementById('ageIn').value.trim();
            const time = document.getElementById('timeIn').value.trim();
            const price = document.getElementById('priceIn').value.trim();
            const isResting = document.getElementById('restingIn').checked;
            
            // Validation
            if (!name) {
                showNotification('‚ùå ·Äî·Ä¨·Äô·Ää·Ä∫·Äë·Ää·Ä∑·Ä∫·Äï·Ä±·Ä∏·Äï·Ä´', 'error');
                document.getElementById('nameIn').focus();
                return;
            }
            
            // Upload images
            showNotification('üîº ·Äï·ÄØ·Ä∂·Äô·Äª·Ä¨·Ä∏·Äê·ÄÑ·Ä∫·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫...', 'info');
            const imageUrls = await uploadImages();
            
            if (!imageUrls || imageUrls.length === 0) {
                showNotification('‚ùå ·Ä°·Äî·Ää·Ä∫·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏·Äï·ÄØ·Ä∂·Äê·ÄÖ·Ä∫·Äï·ÄØ·Ä∂·Äê·ÄÑ·Ä∫·Äï·Ä±·Ä∏·Äï·Ä´', 'error');
                return;
            }
            
            // Create new post object
            const newPost = {
                name,
                age: age || "N/A",
                time: time || "24/7",
                price: price || "·ÄÖ·Äª·Ä±·Ä∏·Äî·Äæ·ÄØ·Äî·Ä∫·Ä∏·Äô·Ä±·Ä∏·Äô·Ää·Ä∫",
                images: imageUrls,
                isResting,
                createdAt: Date.now(),
                updatedAt: Date.now()
            };
            
            // Push to Firebase
            db.push(newPost)
                .then(() => {
                    showNotification('‚úÖ Post ·Äê·ÄÑ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ', 'success');
                    clearForm();
                    closeAdmin();
                })
                .catch((error) => {
                    showNotification(`‚ùå Error: ${error.message}`, 'error');
                });
        }
        
        // Open Edit Modal
        function openEditModal(postId) {
            if (!isAdmin) {
                showNotification('‚ö†Ô∏è Admin ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·Äº·ÄÑ·Ä∑·Ä∫·Äû·Ä¨ ·Äï·Äº·ÄÑ·Ä∫·ÄÜ·ÄÑ·Ä∫·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫', 'warning');
                return;
            }
            
            const post = currentPosts.find(p => p.id === postId);
            if (!post) return;
            
            editingPostId = postId;
            editingImages = post.images.map(url => ({ url, preview: url, isNew: false }));
            
            // Fill form with post data
            document.getElementById('editName').value = post.name || '';
            document.getElementById('editAge').value = post.age || '';
            document.getElementById('editTime').value = post.time || '';
            document.getElementById('editPrice').value = post.price || '';
            document.getElementById('editResting').checked = post.isResting || false;
            
            updateEditImagePreview();
            editModal.classList.remove('hidden');
        }
        
        // Close Edit Modal
        function closeEditModal() {
            editModal.classList.add('hidden');
            editingPostId = null;
            editingImages = [];
        }
        
        // Save Edit
        async function saveEdit() {
            const name = document.getElementById('editName').value.trim();
            const age = document.getElementById('editAge').value.trim();
            const time = document.getElementById('editTime').value.trim();
            const price = document.getElementById('editPrice').value.trim();
            const isResting = document.getElementById('editResting').checked;
            
            if (!name) {
                showNotification('‚ùå ·Äî·Ä¨·Äô·Ää·Ä∫·Äë·Ää·Ä∑·Ä∫·Äï·Ä±·Ä∏·Äï·Ä´', 'error');
                return;
            }
            
            // Upload new images if any
            let imageUrls = editingImages.map(img => img.url).filter(url => url);
            
            const hasNewImages = editingImages.some(img => img.isNew && !img.url);
            if (hasNewImages) {
                showNotification('üîº ·Äï·ÄØ·Ä∂·Ä°·Äû·ÄÖ·Ä∫·Äô·Äª·Ä¨·Ä∏·Äê·ÄÑ·Ä∫·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫...', 'info');
                const uploadedUrls = await uploadEditImages();
                if (uploadedUrls) {
                    imageUrls = uploadedUrls;
                }
            }
            
            if (imageUrls.length === 0) {
                showNotification('‚ùå ·Ä°·Äî·Ää·Ä∫·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏·Äï·ÄØ·Ä∂·Äê·ÄÖ·Ä∫·Äï·ÄØ·Ä∂·Äõ·Äæ·Ä≠·Äõ·Äï·Ä´·Äô·Ää·Ä∫', 'error');
                return;
            }
            
            // Update post in Firebase
            db.child(editingPostId).update({
                name,
                age: age || "N/A",
                time: time || "24/7",
                price: price || "·ÄÖ·Äª·Ä±·Ä∏·Äî·Äæ·ÄØ·Äî·Ä∫·Ä∏·Äô·Ä±·Ä∏·Äô·Ää·Ä∫",
                images: imageUrls,
                isResting,
                updatedAt: Date.now()
            })
            .then(() => {
                showNotification('‚úÖ Post ·Äï·Äº·ÄÑ·Ä∫·ÄÜ·ÄÑ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ', 'success');
                closeEditModal();
            })
            .catch((error) => {
                showNotification(`‚ùå Error: ${error.message}`, 'error');
            });
        }
        
        // Update Resting Status
        function updateRest(id, status) {
            if (!isAdmin) {
                showNotification('‚ö†Ô∏è Admin ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·Äº·ÄÑ·Ä∑·Ä∫·Äû·Ä¨ ·Äï·Äº·ÄÑ·Ä∫·ÄÜ·ÄÑ·Ä∫·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫', 'warning');
                return;
            }
            
            const actionText = status ? '·Äî·Ä¨·Ä∏·Äë·Ä¨·Ä∏' : '·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äú·Ä≠·ÄØ·ÄÄ·Ä∫';
            if (confirm(`·Äí·ÄÆ post ·ÄÄ·Ä≠·ÄØ "${actionText}" ·Äô·Äæ·Ä¨·Äû·Ä±·ÄÅ·Äª·Ä¨·Äï·Ä´·Äû·Äú·Ä¨·Ä∏?`)) {
                db.child(id).update({ 
                    isResting: status,
                    updatedAt: Date.now()
                });
                
                showNotification(`‚úÖ ${actionText} ·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ`, 'success');
            }
        }
        
        // Delete Post
        function deletePost(id) {
            if (!isAdmin) {
                showNotification('‚ö†Ô∏è Admin ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·Äº·ÄÑ·Ä∑·Ä∫·Äû·Ä¨ ·Äñ·Äª·ÄÄ·Ä∫·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫', 'warning');
                return;
            }
            
            if (confirm("üóëÔ∏è ·Äí·ÄÆ post ·ÄÄ·Ä≠·ÄØ ·Ä°·Äï·Äº·ÄÆ·Ä∏·Äñ·Äª·ÄÄ·Ä∫·Äô·Äæ·Ä¨·Äû·Ä±·ÄÅ·Äª·Ä¨·Äï·Ä´·Äû·Äú·Ä¨·Ä∏?")) {
                db.child(id).remove()
                    .then(() => {
                        showNotification('‚úÖ Post ·Äñ·Äª·ÄÄ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ', 'success');
                    })
                    .catch((error) => {
                        showNotification(`‚ùå Error: ${error.message}`, 'error');
                    });
            }
        }
        
        // ============================================
        // POST DISPLAY FUNCTIONS
        // ============================================
        
        // Refresh Posts
        function refreshPosts() {
            refreshBtn.classList.add('animate-spin');
            showNotification('üîÑ Post ·Äô·Äª·Ä¨·Ä∏·Äï·Äº·Äî·Ä∫·Äú·Ää·Ä∫·Äõ·Äö·Ä∞·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫...', 'info');
            
            setTimeout(() => {
                refreshBtn.classList.remove('animate-spin');
                loadPosts();
            }, 800);
        }
        
        // Scroll to Top
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // Format Date
        function formatDate(timestamp) {
            if (!timestamp) return "";
            const date = new Date(timestamp);
            return date.toLocaleDateString("my-MM", {
                day: 'numeric',
                month: 'short',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        // Show Notification
        function showNotification(message, type) {
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.remove();
            }
            
            const colors = {
                success: 'bg-green-500/90',
                error: 'bg-red-500/90',
                warning: 'bg-yellow-500/90',
                info: 'bg-blue-500/90'
            };
            
            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è'
            };
            
            const notification = document.createElement('div');
            notification.className = `notification fixed top-24 left-1/2 transform -translate-x-1/2 ${colors[type]} text-white py-3 px-6 rounded-2xl shadow-2xl z-50 font-bold max-w-md text-center slide-in`;
            notification.innerHTML = `${icons[type]} ${message}`;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translate(-50%, -20px)';
                    notification.style.transition = 'all 0.3s ease';
                    
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.remove();
                        }
                    }, 300);
                }
            }, 3000);
        }
        
        // Load and Display Posts
        function loadPosts() {
            db.on('value', (snapshot) => {
                const data = snapshot.val();
                loading.classList.add('hidden');
                
                if (!data) {
                    postFeed.innerHTML = `
                        <div class="text-center py-20 fade-in">
                            <div class="glass rounded-3xl p-10 mx-4">
                                <i class="fas fa-box-open text-7xl text-gray-600 mb-6"></i>
                                <p class="text-gray-400 text-xl font-bold mb-2">Post ·Äô·Äõ·Äæ·Ä≠·Äû·Ä±·Ä∏·Äï·Ä´...</p>
                                <p class="text-gray-500 mb-6">·Äï·Äë·Äô·ÄÜ·ÄØ·Ä∂·Ä∏ post ·Äê·ÄÑ·Ä∫·Äõ·Äî·Ä∫ Admin ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·Äº·ÄÑ·Ä∑·Ä∫·Äù·ÄÑ·Ä∫·Äï·Ä´</p>
                                <button onclick="openAdminPanel()" class="bg-gradient-to-r from-pink-600 to-purple-700 text-white py-3 px-8 rounded-2xl font-bold hover:scale-105 transition-transform duration-300">
                                    <i class="fas fa-user-shield mr-2"></i>Admin ·Äù·ÄÑ·Ä∫·Äõ·Äî·Ä∫
                                </button>
                            </div>
                        </div>
                    `;
                    postCount.textContent = "0";
                    availableCount.textContent = "0";
                    restingCount.textContent = "0";
                    return;
                }
                
                // Convert object to array
                const postList = Object.keys(data).map(key => ({ 
                    id: key, 
                    ...data[key] 
                }));
                
                // Store for later use
                currentPosts = postList;
                
                // Sort by date (newest first)
                postList.sort((a, b) => (b.createdAt || 0) - (a.createdAt || 0));
                
                // Count available and resting
                const availablePosts = postList.filter(post => !post.isResting);
                const restingPosts = postList.filter(post => post.isResting);
                
                // Update counters
                postCount.textContent = postList.length;
                availableCount.textContent = availablePosts.length;
                restingCount.textContent = restingPosts.length;
                
                // Clear feed
                postFeed.innerHTML = '';
                
                // Create HTML for each post
                postList.forEach((post, index) => {
                    setTimeout(() => {
                        const card = document.createElement('div');
                        card.className = `post-card glass rounded-[2.5rem] overflow-hidden border border-white/10 shadow-2xl fade-in`;
                        card.style.animationDelay = `${index * 0.1}s`;
                        
                        // Determine status
                        const statusText = post.isResting ? "·Äö·Ä¨·Äö·ÄÆ·Äî·Ä¨·Ä∏·Äë·Ä¨·Ä∏·Äï·Ä´·Äû·Ää·Ä∫" : "·Äõ·Äõ·Äæ·Ä≠·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫";
                        const statusColor = post.isResting ? "text-yellow-400" : "text-green-400";
                        const statusIcon = post.isResting ? "fa-clock" : "fa-check-circle";
                        const badgeClass = post.isResting ? "resting-badge" : "available-badge";
                        
                        card.innerHTML = `
                            <div class="relative">
                                <!-- IMAGE SECTION - DIFFERENT FOR RESTING VS AVAILABLE -->
                                ${post.isResting ? `
                                    <!-- RESTING: NO IMAGES, ONLY MESSAGE -->
                                    <div class="slider-container p-4">
                                        <div class="resting-image-placeholder">
                                            <i class="fas fa-clock text-5xl text-yellow-500 mb-4 animate-pulse"></i>
                                            <h3 class="text-xl font-black text-white mb-2">·Äö·Ä¨·Äö·ÄÆ·Äî·Ä¨·Ä∏·Äë·Ä¨·Ä∏·Äï·Ä´·Äû·Ää·Ä∫</h3>
                                            <p class="text-gray-300 text-center text-sm px-4">
                                                ·Äú·ÄÄ·Ä∫·Äõ·Äæ·Ä≠·Äù·Äî·Ä∫·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äæ·ÄØ ·Äô·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´<br>
                                                ·Äî·Ä±·Ä¨·ÄÄ·Ä∫·Äô·Äæ·Äï·Äº·Äî·Ä∫·ÄÜ·ÄÄ·Ä∫·Äû·ÄΩ·Äö·Ä∫·Äï·Ä´·Äô·Ää·Ä∫
                                            </p>
                                        </div>
                                    </div>
                                    
                                    <!-- Status Badge for Resting -->
                                    <div class="absolute top-4 right-4 ${badgeClass} px-4 py-2 rounded-full shadow-lg">
                                        <span class="text-white font-bold text-sm">
                                            <i class="fas ${statusIcon} mr-2"></i>${statusText}
                                        </span>
                                    </div>
                                ` : `
                                    <!-- AVAILABLE: SHOW ACTUAL IMAGES -->
                                    <div class="slider-container p-4">
                                        ${(post.images || []).map(img => `
                                            <img src="${img}" 
                                                 class="slide-item" 
                                                 onerror="this.src='https://images.unsplash.com/photo-1633332755192-727a05c4013d?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80'"
                                                 alt="${post.name}"
                                                 loading="lazy">
                                        `).join('')}
                                    </div>
                                    
                                    <!-- Status Badge for Available -->
                                    <div class="absolute top-4 right-4 ${badgeClass} px-4 py-2 rounded-full shadow-lg">
                                        <span class="text-white font-bold text-sm">
                                            <i class="fas ${statusIcon} mr-2"></i>${statusText}
                                        </span>
                                    </div>
                                    
                                    <!-- Image Count Indicator -->
                                    <div class="absolute bottom-4 right-4 bg-black/70 px-3 py-1 rounded-full">
                                        <span class="text-white text-xs font-bold">
                                            <i class="fas fa-image mr-1"></i>${(post.images || []).length}
                                        </span>
                                    </div>
                                `}
                            </div>
                            
                            <!-- POST DETAILS -->
                            <div class="p-6 md:p-8">
                                <div class="flex justify-between items-start mb-6">
                                    <div class="flex-1">
                                        <h2 class="text-3xl md:text-4xl font-black ${post.isResting ? 'text-gray-400' : 'text-white'} mb-2">
                                            ${post.name}
                                        </h2>
                                        <div class="flex flex-wrap items-center gap-3 mt-3">
                                            <span class="bg-pink-500/20 text-pink-400 px-3 py-1 rounded-full text-sm font-bold">
                                                <i class="fas fa-user mr-1"></i>Age: ${post.age}
                                            </span>
                                            <span class="bg-blue-500/20 text-blue-400 px-3 py-1 rounded-full text-sm font-bold">
                                                <i class="fas fa-clock mr-1"></i>${post.time}
                                            </span>
                                        </div>
                                    </div>
                                    <div class="text-right ml-4">
                                        <div class="text-2xl font-black text-white bg-gradient-to-r from-pink-600 to-purple-700 px-5 py-3 rounded-2xl shadow-lg min-w-[120px]">
                                            ${post.price}
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- CONTACT BUTTON -->
                                <a href="https://www.facebook.com/profile.php?id=61586281884184" 
                                   target="_blank"
                                   class="block w-full btn-primary text-center py-4 rounded-3xl font-black text-xl mb-6 shadow-xl hover:shadow-2xl transition-all duration-300 ${post.isResting ? 'opacity-50 cursor-not-allowed' : ''}"
                                   ${post.isResting ? 'onclick="return false;"' : ''}>
                                   <i class="fab fa-facebook-messenger mr-3"></i> 
                                   ${post.isResting ? '·Äö·Ä¨·Äö·ÄÆ·Äô·ÄÜ·ÄÄ·Ä∫·Äû·ÄΩ·Äö·Ä∫·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´' : '·ÄÜ·ÄÄ·Ä∫·Äû·ÄΩ·Äö·Ä∫·Äõ·Äî·Ä∫ (FB)'}
                                </a>
                                
                                <!-- ADMIN CONTROLS -->
                                ${isAdmin ? `
                                    <div class="admin-controls rounded-2xl p-4 mt-6">
                                        <div class="grid grid-cols-3 gap-2">
                                            <button onclick="openEditModal('${post.id}')" 
                                                    class="bg-gradient-to-r from-blue-600 to-blue-700 hover:opacity-90 text-white py-3 rounded-xl font-bold text-sm transition-all duration-300 hover:scale-[1.02]">
                                                <i class="fas fa-edit mr-1"></i> ·Äï·Äº·ÄÑ·Ä∫·Äô·Ää·Ä∫
                                            </button>
                                            <button onclick="updateRest('${post.id}', ${!post.isResting})" 
                                                    class="bg-gradient-to-r ${post.isResting ? 'from-green-600 to-emerald-700' : 'from-yellow-600 to-amber-700'} hover:opacity-90 text-white py-3 rounded-xl font-bold text-sm transition-all duration-300 hover:scale-[1.02]">
                                                <i class="fas fa-power-off mr-1"></i> 
                                                ${post.isResting ? '·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äô·Ää·Ä∫' : '·Äî·Ä¨·Ä∏·Äô·Ää·Ä∫'}
                                            </button>
                                            <button onclick="deletePost('${post.id}')" 
                                                    class="bg-gradient-to-r from-red-600 to-rose-700 hover:opacity-90 text-white py-3 rounded-xl font-bold text-sm transition-all duration-300 hover:scale-[1.02]">
                                                <i class="fas fa-trash mr-1"></i> ·Äñ·Äª·ÄÄ·Ä∫·Äô·Ää·Ä∫
                                            </button>
                                        </div>
                                        <p class="text-gray-400 text-xs mt-3 text-center">
                                            <i class="far fa-clock mr-1"></i>
                                            ·Äî·Ä±·Ä¨·ÄÄ·Ä∫·ÄÜ·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄÑ·Ä∫·ÄÜ·ÄÑ·Ä∫·ÄÅ·Äª·Ä≠·Äî·Ä∫: ${formatDate(post.updatedAt || post.createdAt)}
                                        </p>
                                    </div>
                                ` : ''}
                            </div>
                        `;
                        
                        postFeed.appendChild(card);
                    }, index * 100);
                });
            }, (error) => {
                console.error("Error loading posts:", error);
                loading.classList.add('hidden');
                postFeed.innerHTML = `
                    <div class="text-center py-20 fade-in">
                        <div class="glass rounded-3xl p-10 mx-4 border border-red-500/30">
                            <i class="fas fa-exclamation-triangle text-7xl text-red-500 mb-6"></i>
                            <p class="text-red-400 text-xl font-bold mb-2">·Äí·Ä±·Äê·Ä¨·Äõ·Äö·Ä∞·Äõ·Ä¨·Äê·ÄΩ·ÄÑ·Ä∫ ·Ä°·Äô·Äæ·Ä¨·Ä∏·Äê·ÄÖ·Ä∫·ÄÅ·ÄØ·Äñ·Äº·ÄÖ·Ä∫·Äî·Ä±·Äû·Ää·Ä∫</p>
                            <p class="text-gray-400 mb-6">·Ä°·ÄÑ·Ä∫·Äê·Ä¨·Äî·ÄÄ·Ä∫·ÄÅ·Äª·Ä≠·Äê·Ä∫·ÄÜ·ÄÄ·Ä∫·Äô·Äæ·ÄØ·ÄÄ·Ä≠·ÄØ ·ÄÖ·ÄÖ·Ä∫·ÄÜ·Ä±·Ä∏·Äï·Ä´</p>
                            <button onclick="refreshPosts()" class="bg-gradient-to-r from-pink-600 to-purple-700 text-white py-3 px-8 rounded-2xl font-bold hover:scale-105 transition-transform duration-300">
                                <i class="fas fa-sync-alt mr-2"></i>·Äï·Äº·Äî·Ä∫·ÄÄ·Äº·Ä≠·ÄØ·Ä∏·ÄÖ·Ä¨·Ä∏·Äô·Ää·Ä∫
                            </button>
                        </div>
                    </div>
                `;
            });
        }
        
        // ============================================
        // INITIALIZE APP
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize image upload
            initializeImageUpload();
            
            // Load posts
            loadPosts();
            
            // Click on header to open admin panel
            document.getElementById('adminTrigger').addEventListener('click', openAdminPanel);
            document.getElementById('adminBtn').addEventListener('click', openAdminPanel);
            
            // Close admin panel when clicking outside
            document.addEventListener('click', function(event) {
                if (adminPanel && !adminPanel.contains(event.target) && 
                    event.target.id !== 'adminTrigger' && 
                    event.target.id !== 'adminBtn' && 
                    !event.target.closest('#adminBtn') &&
                    !event.target.closest('#adminTrigger')) {
                    closeAdmin();
                }
            });
            
            // Prevent closing when clicking inside admin panel
            if (adminPanel) {
                adminPanel.addEventListener('click', function(event) {
                    event.stopPropagation();
                });
            }
            
            // Close edit modal when clicking outside
            editModal.addEventListener('click', function(event) {
                if (event.target === editModal) {
                    closeEditModal();
                }
            });
            
            // Add keyboard shortcuts
            document.addEventListener('keydown', function(event) {
                // Ctrl + A to open admin (Windows/Linux)
                // Cmd + A to open admin (Mac)
                if ((event.ctrlKey || event.metaKey) && event.key === 'a') {
                    event.preventDefault();
                    openAdminPanel();
                }
                
                // Escape to close admin/edit modal
                if (event.key === 'Escape') {
                    if (!editModal.classList.contains('hidden')) {
                        closeEditModal();
                    } else {
                        closeAdmin();
                    }
                }
                
                // F5 to refresh
                if (event.key === 'F5') {
                    event.preventDefault();
                    refreshPosts();
                }
            });
            
            // Auto-refresh every 30 seconds
            setInterval(refreshPosts, 30000);
        });
        
        // Image error handler
        window.addEventListener('error', function(e) {
            if (e.target.tagName === 'IMG') {
                e.target.src = 'https://images.unsplash.com/photo-1633332755192-727a05c4013d?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80';
                e.target.onerror = null;
            }
        }, true);
        
        // Online/Offline detection
        window.addEventListener('online', function() {
            showNotification('üåê ·Ä°·ÄÑ·Ä∫·Äê·Ä¨·Äî·ÄÄ·Ä∫·ÄÅ·Äª·Ä≠·Äê·Ä∫·ÄÜ·ÄÄ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ', 'success');
            refreshPosts();
        });
        
        window.addEventListener('offline', function() {
            showNotification('üìµ ·Ä°·ÄÑ·Ä∫·Äê·Ä¨·Äî·ÄÄ·Ä∫·ÄÅ·Äª·Ä≠·Äê·Ä∫·ÄÜ·ÄÄ·Ä∫·Äô·Äæ·ÄØ·Äï·Äº·Äê·Ä∫·Äê·Ä±·Ä¨·ÄÄ·Ä∫·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫', 'error');
        });
    </script>
</body>
</html>
